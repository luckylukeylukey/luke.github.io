<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alpha Casino - Where You Always Pay</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #111111 0%, #1a1a1a 50%, #111111 100%);
            min-height: 100vh;
            color: #f5f5f5;
            overflow-x: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Animated background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
            animation: subtleGlow 8s ease-in-out infinite;
        }

        @keyframes subtleGlow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        /* ===== HEADER ===== */
        .casino-header {
            text-align: center;
            padding: 2rem 1rem;
            position: relative;
            z-index: 10;
        }

        .casino-logo {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            font-weight: 900;
            color: #d4af37;
            letter-spacing: 0.3rem;
            text-shadow: 
                0 0 20px rgba(212, 175, 55, 0.5),
                0 4px 8px rgba(0, 0, 0, 0.8);
            margin-bottom: 0.5rem;
            position: relative;
        }

        .casino-logo::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #d4af37, transparent);
            opacity: 0.6;
        }

        .casino-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            font-weight: 300;
            color: #ff6b6b;
            letter-spacing: 0.2rem;
            text-transform: uppercase;
            opacity: 0.9;
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
            flex: 1;
            justify-content: center;
        }

        /* ===== SLOT MACHINE ===== */
        .slot-machine {
            background: linear-gradient(145deg, #1a1a1a, #111111);
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 40px rgba(212, 175, 55, 0.1);
            position: relative;
            max-width: 900px;
            width: 100%;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .machine-frame {
            background: #0a0a0a;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 
                inset 0 4px 12px rgba(0, 0, 0, 0.9),
                0 0 20px rgba(212, 175, 55, 0.1);
            position: relative;
            border: 2px solid #333;
        }

        /* ===== REELS ===== */
        .reels-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
            justify-content: center;
            position: relative;
        }

        .reel {
            width: 120px;
            height: 150px;
            background: linear-gradient(180deg, #1a1a1a, #111111);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            border: 2px solid #333;
            box-shadow: 
                inset 0 2px 8px rgba(0, 0, 0, 0.8),
                0 0 10px rgba(212, 175, 55, 0.1);
        }

        .reel-strip {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s ease-out;
        }

        .symbol {
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            background: linear-gradient(180deg, #222, #111);
            border-bottom: 1px solid #333;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
            position: relative;
        }

        .symbol.winning {
            background: linear-gradient(180deg, #d4af37, #b8941f);
            box-shadow: 
                0 0 20px rgba(212, 175, 55, 0.8),
                inset 0 0 20px rgba(255, 255, 255, 0.2);
            animation: symbolGlow 1s ease-in-out;
        }

        .symbol.losing {
            background: linear-gradient(180deg, #ff6b6b, #e74c3c);
            box-shadow: 
                0 0 20px rgba(255, 107, 107, 0.8),
                inset 0 0 20px rgba(255, 255, 255, 0.2);
            animation: symbolPulse 1s ease-in-out;
        }

        @keyframes symbolGlow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes symbolPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.95); }
        }

        /* Spinning animation */
        .reel-strip.spinning {
            animation: reelSpin 0.05s linear infinite;
        }

        @keyframes reelSpin {
            from { transform: translateY(0); }
            to { transform: translateY(-150px); }
        }

        /* ===== GAME CONTROLS ===== */
        .game-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        .debt-section {
            margin-bottom: 1rem;
        }

        .total-debt-display {
            text-align: center;
            background: rgba(255, 107, 107, 0.15);
            padding: 1.5rem 2rem;
            border-radius: 15px;
            border: 2px solid rgba(255, 107, 107, 0.4);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.2);
            min-width: 200px;
        }

        .total-debt-display .label {
            display: block;
            font-size: 1rem;
            color: #ff6b6b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.15rem;
            margin-bottom: 0.5rem;
        }

        .total-debt-display .amount {
            display: block;
            font-size: 2.5rem;
            font-weight: 900;
            color: #f5f5f5;
            font-family: 'Playfair Display', serif;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Spin Button */
        .spin-btn {
            width: 150px;
            height: 150px;
            background: linear-gradient(145deg, #d4af37, #b8941f);
            border: 4px solid #ffd700;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 
                0 8px 25px rgba(212, 175, 55, 0.4),
                inset 0 2px 5px rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .spin-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.4s ease;
        }

        .spin-btn:hover::before {
            width: 200px;
            height: 200px;
        }

        .spin-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 12px 35px rgba(212, 175, 55, 0.5),
                inset 0 2px 5px rgba(255, 255, 255, 0.3);
        }

        .spin-btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        .spin-btn:disabled {
            background: linear-gradient(145deg, #666, #555);
            border-color: #777;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .spin-text {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: #111;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
            z-index: 1;
        }

        .spin-icon {
            font-size: 2rem;
            color: #111;
            z-index: 1;
            margin-top: 0.2rem;
        }

        .spin-btn.spinning .spin-icon {
            animation: spinRotate 0.5s linear infinite;
        }

        @keyframes spinRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Spin Result Section */
        .spin-result {
            text-align: center;
            margin-top: 1rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 1rem;
            max-width: 500px;
            width: 100%;
        }

        .spin-debt-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            padding: 0.8rem 1.5rem;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 107, 107, 0.3);
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .spin-debt-display.active {
            opacity: 1;
            transform: translateY(0);
        }

        .spin-debt-label {
            font-size: 1rem;
            color: #ff6b6b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
        }

        .spin-debt-amount {
            font-size: 1.8rem;
            font-weight: 700;
            color: #f5f5f5;
            font-family: 'Playfair Display', serif;
        }

        .spin-explanation {
            font-size: 1.1rem;
            color: #d4af37;
            font-weight: 500;
            line-height: 1.4;
            font-style: italic;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease 0.1s;
        }

        .spin-explanation.active {
            opacity: 1;
            transform: translateY(0);
        }

        .spin-explanation.dare {
            color: #ff6b6b;
            font-weight: 600;
        }

        /* Message Bar */
        .message-bar {
            text-align: center;
            margin-top: 1rem;
            min-height: 3rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        #game-message {
            font-size: 1.2rem;
            font-weight: 600;
            color: #d4af37;
            text-transform: uppercase;
            letter-spacing: 0.1rem;
            line-height: 1.4;
        }

        /* ===== SPECIAL OVERLAYS ===== */
        .dare-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .dare-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .dare-content {
            text-align: center;
            background: linear-gradient(145deg, #1a1a1a, #111111);
            padding: 3rem;
            border-radius: 20px;
            border: 3px solid #ff6b6b;
            box-shadow: 0 0 50px rgba(255, 107, 107, 0.5);
            max-width: 600px;
            margin: 1rem;
        }

        .dare-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: #ff6b6b;
            font-weight: 900;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }

        .dare-text {
            font-size: 1.3rem;
            color: #f5f5f5;
            line-height: 1.6;
            margin-bottom: 2rem;
            font-weight: 500;
        }

        .dare-dismiss {
            background: linear-gradient(145deg, #ff6b6b, #e74c3c);
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .dare-dismiss:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        /* ===== RULES PANEL ===== */
        .rules-toggle {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 100;
        }

        .toggle-btn {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid #d4af37;
            color: #d4af37;
            padding: 0.8rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .toggle-btn:hover {
            background: rgba(212, 175, 55, 0.1);
            transform: translateY(-2px);
        }

        .rules-panel {
            position: fixed;
            top: 50%;
            right: -400px;
            transform: translateY(-50%);
            width: 350px;
            background: linear-gradient(145deg, #1a1a1a, #111111);
            border-radius: 20px 0 0 20px;
            padding: 2rem;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.8);
            transition: right 0.3s ease;
            border: 1px solid rgba(212, 175, 55, 0.2);
            z-index: 99;
            max-height: 80vh;
            overflow-y: auto;
        }

        .rules-panel.active {
            right: 0;
        }

        .rules-panel h3 {
            font-family: 'Playfair Display', serif;
            color: #d4af37;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
            font-weight: 700;
        }

        .rules-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 3px solid #d4af37;
        }

        .rules-section h4 {
            color: #ff6b6b;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .rules-section p {
            font-size: 0.95rem;
            line-height: 1.4;
            color: #f5f5f5;
        }

        /* ===== FOOTER ===== */
        .casino-footer {
            text-align: center;
            padding: 2rem;
            color: rgba(245, 245, 245, 0.6);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .casino-logo {
                font-size: 2.5rem;
                letter-spacing: 0.2rem;
            }
            
            .slot-machine {
                padding: 2rem 1rem;
                margin: 1rem;
            }
            
            .machine-frame {
                padding: 1.5rem 1rem;
            }
            
            .reels-container {
                gap: 0.5rem;
            }
            
            .reel {
                width: 60px;
                height: 80px;
            }
            
            .symbol {
                height: 80px;
                font-size: 2rem;
            }
            
            .spin-btn {
                width: 120px;
                height: 120px;
            }
            
            .rules-panel {
                width: 280px;
            }
            
            .rules-toggle {
                top: 1rem;
                right: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="rules-toggle">
        <button class="toggle-btn" onclick="toggleRules()">üìã Rules</button>
    </div>

    <header class="casino-header">
        <h1 class="casino-logo">ALPHA CASINO</h1>
        <p class="casino-subtitle">Where You Always Pay to Play</p>
    </header>

    <main class="main-content">
        <section class="slot-machine" id="slot-machine">
            <div class="machine-frame">
                <div class="reels-container" id="reels-container">
                    <div class="reel" id="reel-1">
                        <div class="reel-strip" data-reel="1"></div>
                    </div>
                    <div class="reel" id="reel-2">
                        <div class="reel-strip" data-reel="2"></div>
                    </div>
                    <div class="reel" id="reel-3">
                        <div class="reel-strip" data-reel="3"></div>
                    </div>
                    <div class="reel" id="reel-4">
                        <div class="reel-strip" data-reel="4"></div>
                    </div>
                    <div class="reel" id="reel-5">
                        <div class="reel-strip" data-reel="5"></div>
                    </div>
                </div>
            </div>

            <div class="game-controls">
                <div class="debt-section">
                    <div class="total-debt-display">
                        <span class="label">Total Debt</span>
                        <span class="amount" id="total-debt">$0</span>
                    </div>
                </div>

                <button class="spin-btn" id="spin-button">
                    <span class="spin-text">SPIN</span>
                    <div class="spin-icon">‚ü≤</div>
                </button>

                <div class="spin-result" id="spin-result">
                    <div class="spin-debt-display" id="spin-debt-display">
                        <span class="spin-debt-label">This Spin:</span>
                        <span class="spin-debt-amount" id="spin-debt-amount">$0</span>
                    </div>
                    <div class="spin-explanation" id="spin-explanation">
                        Ready to spin and rack up some debt?
                    </div>
                </div>
            </div>

            <div class="message-bar" id="message-bar">
                <span id="game-message">Ready to lose money?</span>
            </div>
        </section>
    </main>

    <div class="rules-panel" id="rules-panel">
        <h3>How This Works</h3>
        
        <div class="rules-section">
            <h4>üé∞ The ALPHA Casino</h4>
            <p>This isn't your typical casino. Here, most spins cost YOU money instead of paying out. The rarer the result, the more you owe!</p>
        </div>
        
        <div class="rules-section">
            <h4>üí∏ Debt System</h4>
            <p>‚Ä¢ No matches: $5-$10 debt<br>
            ‚Ä¢ One pair: $10-$25 debt<br>
            ‚Ä¢ Two pairs: $25-$40 debt<br>
            ‚Ä¢ Three of a kind: $45-$75 debt<br>
            ‚Ä¢ Four of a kind: $80-$100 debt<br>
            ‚Ä¢ Full house: $85-$95 debt<br>
            ‚Ä¢ Five of a kind: Special dare!</p>
        </div>
        
        <div class="rules-section">
            <h4>üé≠ Special Prizes</h4>
            <p>Very rare combinations unlock "special prizes" - humiliating dares instead of money. These are the only "wins" in this reverse casino!</p>
        </div>
        
        <div class="rules-section">
            <h4>üéØ Symbols</h4>
            <p><strong>Money Tier (Common):</strong><br>
            ü§ë Money Face, üí∞ Money Bag, üí∏ Flying Cash, üí≤ Dollar Sign, üí≥ Credit Card<br><br>
            <strong>Luxury Tier (Uncommon):</strong><br>
            üíé Diamond, üî∑ Blue Diamond, üì¶ Box of Cash, üíç Ring<br><br>
            <strong>Casino Tier (Rare):</strong><br>
            üé∞ Slot Machine, üé≤ Dice, üÉè Playing Card<br><br>
            <strong>Premium Tier (Very Rare):</strong><br>
            üëë Crown, ‚≠ê Star<br><br>
            <strong>Ultimate Tier (Ultra Rare):</strong><br>
            Œë Alpha Symbol</p>
        </div>
    </div>

    <div class="dare-overlay" id="dare-overlay">
        <div class="dare-content">
            <h2 class="dare-title">SPECIAL PRIZE!</h2>
            <p class="dare-text" id="dare-text"></p>
            <button class="dare-dismiss" onclick="dismissDare()">Accept Your Fate</button>
        </div>
    </div>

    <footer class="casino-footer">
        <p>&copy; 2025 Alpha Casino. You always lose here. Play irresponsibly.</p>
    </footer>

    <script>
        // Global variables
        let gameState = {
            totalDebt: 0,
            isSpinning: false,
            spinsCount: 0
        };

        let gameElements = {};

        // Game configuration
        const GAME_CONFIG = {
            symbols: ['ü§ë', 'üí∞', 'üí∏', 'üí≤', 'üí≥', 'üíé', 'üî∑', 'üì¶', 'üëë', 'üé∞', 'üé≤', 'üÉè', 'üíç', '‚≠ê', 'Œë'],
            symbolWeights: {
                'ü§ë': 15, 'üí∞': 15, 'üí∏': 12, 'üí≤': 12, 'üí≥': 10,
                'üíé': 8, 'üî∑': 8, 'üì¶': 7, 'üíç': 6,
                'üé∞': 5, 'üé≤': 4, 'üÉè': 4,
                'üëë': 3, '‚≠ê': 2,
                'Œë': 1
            },
            debtTable: {
                'no_match': [5, 6, 7, 8, 10],
                'one_pair': [10, 15, 20, 25],
                'two_pair': [25, 30, 35, 40],
                'three_kind': [45, 55, 65, 75],
                'four_kind': [80, 90, 100],
                'full_house': [85, 95],
                'five_kind': 'DARE'
            },
            dareTable: [
                "Post a selfie making the most ridiculous face you can manage with the caption 'I lost at Alpha Casino and this is my winner's face!'",
                "Send a voice message to your group chat singing 'Happy Birthday' to yourself in the most dramatic way possible.",
                "Change your profile picture to a drawing you make with your non-dominant hand for 24 hours.",
                "Text someone you haven't talked to in months and say 'I just wanted you to know that you're probably thinking about me right now.'",
                "Record yourself doing a 30-second interpretive dance about your day and post it to your story.",
                "Eat your next meal using only a spoon, even if it's pizza or a sandwich.",
                "Speak in rhymes for the next hour, no matter who you're talking to.",
                "Write and perform a 2-minute dramatic monologue about why socks disappear in the laundry.",
                "Call a local business and ask if they sell 'left-handed screwdrivers' in complete seriousness.",
                "Wear mismatched shoes for the entire day tomorrow (bonus points if you have to go somewhere important)."
            ],
            symbolHeight: 150,
            spinDuration: 1500,
            reelStopDelay: 200
        };

        // Initialize elements
        function initializeElements() {
            gameElements = {
                totalDebt: document.getElementById('total-debt'),
                spinButton: document.getElementById('spin-button'),
                gameMessage: document.getElementById('game-message'),
                dareOverlay: document.getElementById('dare-overlay'),
                dareText: document.getElementById('dare-text'),
                rulesPanel: document.getElementById('rules-panel'),
                spinResult: document.getElementById('spin-result'),
                spinDebtDisplay: document.getElementById('spin-debt-display'),
                spinDebtAmount: document.getElementById('spin-debt-amount'),
                spinExplanation: document.getElementById('spin-explanation')
            };
        }

        // Symbol generation
        function getRandomSymbol() {
            const totalWeight = Object.values(GAME_CONFIG.symbolWeights).reduce((sum, weight) => sum + weight, 0);
            let random = Math.random() * totalWeight;
            
            for (const [symbol, weight] of Object.entries(GAME_CONFIG.symbolWeights)) {
                random -= weight;
                if (random <= 0) {
                    return symbol;
                }
            }
            return GAME_CONFIG.symbols[0];
        }

        // Initialize reels
        function initializeReels() {
            for (let i = 1; i <= 5; i++) {
                const reelElement = document.querySelector(`[data-reel="${i}"]`);
                if (reelElement) {
                    // Generate symbols
                    for (let j = 0; j < 50; j++) {
                        const symbolElement = document.createElement('div');
                        symbolElement.className = 'symbol';
                        symbolElement.textContent = getRandomSymbol();
                        reelElement.appendChild(symbolElement);
                    }
                }
            }
        }

        // Analyze spin results
        function analyzeResult(symbols) {
            console.log('Analyzing symbols:', symbols); // Debug log
            
            const symbolCounts = {};
            symbols.forEach(symbol => {
                symbolCounts[symbol] = (symbolCounts[symbol] || 0) + 1;
            });

            console.log('Symbol counts:', symbolCounts); // Debug log

            const counts = Object.values(symbolCounts);
            const maxCount = Math.max(...counts);
            const uniqueSymbols = Object.keys(symbolCounts).length;

            console.log('Max count:', maxCount, 'Unique symbols:', uniqueSymbols); // Debug log

            // Check for five of a kind (DARE!)
            if (maxCount === 5) {
                return {
                    type: 'five_kind',
                    isDare: true,
                    positions: [0, 1, 2, 3, 4],
                    message: 'JACKPOT! Time for a special prize...'
                };
            }

            // Check for four of a kind
            if (maxCount === 4) {
                return {
                    type: 'four_kind',
                    isDare: false,
                    positions: getMatchingPositions(symbols, maxCount),
                    message: 'Four of a kind! Big debt incoming...'
                };
            }

            // Check for full house (3 of one + 2 of another)
            if (maxCount === 3 && uniqueSymbols === 2) {
                return {
                    type: 'full_house',
                    isDare: false,
                    positions: [0, 1, 2, 3, 4],
                    message: 'Full house! That\'s expensive...'
                };
            }

            // Check for three of a kind
            if (maxCount === 3) {
                return {
                    type: 'three_kind',
                    isDare: false,
                    positions: getMatchingPositions(symbols, maxCount),
                    message: 'Three of a kind! You owe us...'
                };
            }

            // Check for two pairs (2 of one + 2 of another + 1 other)
            const pairCount = counts.filter(count => count === 2).length;
            if (pairCount === 2) {
                return {
                    type: 'two_pair',
                    isDare: false,
                    positions: getAllPairPositions(symbols),
                    message: 'Two pairs! Pay up!'
                };
            }

            // Check for one pair (2 of same)
            if (maxCount === 2) {
                return {
                    type: 'one_pair',
                    isDare: false,
                    positions: getMatchingPositions(symbols, 2),
                    message: 'One pair! That\'ll cost you...'
                };
            }

            // No significant matches
            return {
                type: 'no_match',
                isDare: false,
                positions: [],
                message: 'No matches! Still costs you though...'
            };
        }

        function getMatchingPositions(symbols, targetCount) {
            const symbolCounts = {};
            const positions = {};
            
            symbols.forEach((symbol, index) => {
                if (!symbolCounts[symbol]) {
                    symbolCounts[symbol] = 0;
                    positions[symbol] = [];
                }
                symbolCounts[symbol]++;
                positions[symbol].push(index);
            });

            // Find the symbol with the target count
            for (const [symbol, count] of Object.entries(symbolCounts)) {
                if (count === targetCount) {
                    return positions[symbol];
                }
            }
            return [];
        }

        function getAllPairPositions(symbols) {
            const symbolCounts = {};
            const positions = {};
            
            symbols.forEach((symbol, index) => {
                if (!symbolCounts[symbol]) {
                    symbolCounts[symbol] = 0;
                    positions[symbol] = [];
                }
                symbolCounts[symbol]++;
                positions[symbol].push(index);
            });

            // Get all positions for symbols that appear exactly twice
            let allPairPositions = [];
            for (const [symbol, count] of Object.entries(symbolCounts)) {
                if (count === 2) {
                    allPairPositions = allPairPositions.concat(positions[symbol]);
                }
            }
            return allPairPositions;
        }

        function calculateDebt(resultType) {
            const debtOptions = GAME_CONFIG.debtTable[resultType];
            if (Array.isArray(debtOptions)) {
                return debtOptions[Math.floor(Math.random() * debtOptions.length)];
            }
            return 0;
        }

        function getRandomDare() {
            return GAME_CONFIG.dareTable[Math.floor(Math.random() * GAME_CONFIG.dareTable.length)];
        }

        // UI Updates
        function updateDisplay() {
            if (gameElements.totalDebt) {
                gameElements.totalDebt.textContent = `${gameState.totalDebt}`;
            }
            if (gameElements.spinButton) {
                gameElements.spinButton.disabled = gameState.isSpinning;
            }
        }

        function setMessage(message) {
            if (gameElements.gameMessage) {
                gameElements.gameMessage.textContent = message;
            }
        }

        function showSpinResult(amount, explanation, isDare = false) {
            if (!gameElements.spinDebtDisplay || !gameElements.spinExplanation || !gameElements.spinDebtAmount) {
                return;
            }
            
            // Reset animations
            gameElements.spinDebtDisplay.classList.remove('active');
            gameElements.spinExplanation.classList.remove('active', 'dare');
            
            // Update content
            gameElements.spinDebtAmount.textContent = `${amount}`;
            gameElements.spinExplanation.textContent = explanation;
            
            if (isDare) {
                gameElements.spinExplanation.classList.add('dare');
            }
            
            // Trigger animations
            setTimeout(() => {
                gameElements.spinDebtDisplay.classList.add('active');
                gameElements.spinExplanation.classList.add('active');
            }, 300);
        }

        function getDebtExplanation(resultType) {
            const explanations = {
                'no_match': [
                    'Random symbols cost you money in this reverse casino!',
                    'No matches, but you still owe the house!',
                    'Even losing combinations have a price here!',
                    'The house always wins - especially when you lose!'
                ],
                'one_pair': [
                    'One pair found! Even small matches cost money here!',
                    'Two matching symbols mean you owe us!',
                    'A simple pair is still worth something... to us!'
                ],
                'two_pair': [
                    'Two pairs? That\'s actually pretty rare - pay up!',
                    'Matching pairs are uncommon, so they cost more!',
                    'The more organized your loss, the more you owe!'
                ],
                'three_kind': [
                    'Three of a kind is quite unusual - expensive!',
                    'Rare combinations mean bigger debts!',
                    'The casino charges premium for better patterns!'
                ],
                'four_kind': [
                    'Four matching symbols? That\'s seriously rare!',
                    'Ultra-rare combinations come with ultra-high costs!',
                    'The rarer the result, the bigger the debt!'
                ],
                'full_house': [
                    'A full house is incredibly rare - maximum debt!',
                    'Perfect patterns cost the most in reverse casino!',
                    'The house loves when you get "lucky" like this!'
                ]
            };
            
            const options = explanations[resultType] || explanations['no_match'];
            return options[Math.floor(Math.random() * options.length)];
        }

        function highlightSymbols(positions, isWin = false) {
            clearHighlights();
            positions.forEach(position => {
                const reelStrip = document.querySelector(`[data-reel="${position + 1}"]`);
                if (reelStrip && reelStrip.children[0]) {
                    reelStrip.children[0].classList.add(isWin ? 'winning' : 'losing');
                    setTimeout(() => {
                        if (reelStrip.children[0]) {
                            reelStrip.children[0].classList.remove(isWin ? 'winning' : 'losing');
                        }
                    }, 3000);
                }
            });
        }

        function clearHighlights() {
            for (let i = 1; i <= 5; i++) {
                const reelStrip = document.querySelector(`[data-reel="${i}"]`);
                if (reelStrip) {
                    Array.from(reelStrip.children).forEach(symbol => {
                        symbol.classList.remove('winning', 'losing');
                    });
                }
            }
        }

        function showDare() {
            const dare = getRandomDare();
            if (gameElements.dareText) {
                gameElements.dareText.textContent = dare;
            }
            if (gameElements.dareOverlay) {
                gameElements.dareOverlay.classList.add('active');
            }
            setMessage('Congratulations! You won a special prize!');
        }

        // Main spin function
        function spin() {
            if (gameState.isSpinning) return;
            
            gameState.isSpinning = true;
            gameState.spinsCount++;
            
            if (gameElements.spinButton) {
                gameElements.spinButton.classList.add('spinning');
            }
            setMessage('Spinning... preparing your debt...');
            updateDisplay();
            
            clearHighlights();
            
            // Start spinning animation on all reels
            for (let i = 1; i <= 5; i++) {
                const reelStrip = document.querySelector(`[data-reel="${i}"]`);
                if (reelStrip) {
                    reelStrip.classList.add('spinning');
                }
            }
            
            // Generate final results
            const finalResults = [];
            for (let i = 0; i < 5; i++) {
                finalResults.push(getRandomSymbol());
            }
            
            // Stop reels one by one
            let stoppedReels = 0;
            for (let i = 1; i <= 5; i++) {
                setTimeout(() => {
                    const reelStrip = document.querySelector(`[data-reel="${i}"]`);
                    if (reelStrip) {
                        reelStrip.classList.remove('spinning');
                        
                        // Update the first visible symbol to show the result
                        if (reelStrip.children[0]) {
                            reelStrip.children[0].textContent = finalResults[i - 1];
                        }
                    }
                    
                    stoppedReels++;
                    if (stoppedReels === 5) {
                        // All reels stopped, analyze results
                        setTimeout(() => {
                            const analysis = analyzeResult(finalResults);
                            
                            if (analysis.isDare) {
                                highlightSymbols(analysis.positions, true);
                                showDare();
                                showSpinResult(0, 'Lucky you! No debt this time - just a special prize!', true);
                            } else {
                                const debtAmount = calculateDebt(analysis.type);
                                gameState.totalDebt += debtAmount;
                                
                                if (analysis.positions.length > 0) {
                                    highlightSymbols(analysis.positions, false);
                                }
                                
                                setMessage(`${analysis.message} You owe ${debtAmount}!`);
                                showSpinResult(debtAmount, getDebtExplanation(analysis.type), false);
                            }
                            
                            gameState.isSpinning = false;
                            if (gameElements.spinButton) {
                                gameElements.spinButton.classList.remove('spinning');
                            }
                            updateDisplay();
                        }, 500);
                    }
                }, GAME_CONFIG.spinDuration + (i - 1) * GAME_CONFIG.reelStopDelay);
            }
        }

        // Global functions for buttons
        function toggleRules() {
            if (gameElements.rulesPanel) {
                gameElements.rulesPanel.classList.toggle('active');
            }
        }

        function dismissDare() {
            if (gameElements.dareOverlay) {
                gameElements.dareOverlay.classList.remove('active');
            }
            setMessage('Hope you enjoyed your prize! Ready for another spin?');
        }

        // Event listeners
        function initializeEventListeners() {
            if (gameElements.spinButton) {
                gameElements.spinButton.addEventListener('click', spin);
            }
            
            // Keyboard support
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space' && !gameState.isSpinning) {
                    e.preventDefault();
                    spin();
                }
            });
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initializeElements();
            initializeReels();
            initializeEventListeners();
            updateDisplay();
            setMessage('Ready to lose money?');
        });
    </script>
</body>
</html>
